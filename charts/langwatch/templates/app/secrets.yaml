
{{- include "langwatch.validateSecrets" . }}
{{- if not .Values.secrets.existingSecret }}
{{- if .Values.autogen.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.autogen.secretNames.app | default (printf "%s-app-secrets" .Release.Name) }}
  labels:
    {{- include "langwatch.labels" . | nindent 4 }}
type: Opaque
data:
  {{- $existingSecret := lookup "v1" "Secret" .Release.Namespace (.Values.autogen.secretNames.app | default (printf "%s-app-secrets" .Release.Name)) }}
  {{- if $existingSecret }}
  {{- range $key, $value := $existingSecret.data }}
  {{ $key }}: {{ $value }}
  {{- end }}
  {{- else }}
  API_TOKEN_JWT_SECRET: {{ randAlphaNum 32 | b64enc | quote }}
  CRON_API_KEY:        {{ randAlphaNum 32 | b64enc | quote }}
  METRICS_API_KEY:     {{ randAlphaNum 32 | b64enc | quote }}
  NEXTAUTH_SECRET:     {{ randAlphaNum 32 | b64enc | quote }}
  {{- end }}
{{- end }}
{{- end }}
